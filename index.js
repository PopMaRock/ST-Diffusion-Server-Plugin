(()=>{"use strict";var t={156:function(t,e,o){var n=this&&this.__createBinding||(Object.create?function(t,e,o,n){void 0===n&&(n=o);var r=Object.getOwnPropertyDescriptor(e,o);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[o]}}),Object.defineProperty(t,n,r)}:function(t,e,o,n){void 0===n&&(n=o),t[n]=e[o]}),r=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var o in t)"default"!==o&&Object.prototype.hasOwnProperty.call(t,o)&&n(e,t,o);return r(e,t),e},s=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))((function(r,i){function s(t){try{d(n.next(t))}catch(t){i(t)}}function u(t){try{d(n.throw(t))}catch(t){i(t)}}function d(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(s,u)}d((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.info=void 0,e.init=c,e.exit=a;const u="[sillyTavern-sd-plugin]";function d(t){return`Basic ${Buffer.from(`${t}`).toString("base64")}`}function c(t){return s(this,void 0,void 0,(function*(){const e=(yield function(){return s(this,void 0,void 0,(function*(){return(yield Promise.resolve().then((()=>i(o(268))))).default}))}()).json();t.post("/probe",((t,e)=>e.sendStatus(204))),t.post("/ping",e,((t,e)=>s(this,void 0,void 0,(function*(){try{const{message:o}=t.body;return e.json({message:`Pong! ${o}`})}catch(t){return console.error(u,"Request failed",t),e.status(500).send("Internal Server Error")}})))),t.post("/vaes",e,((t,e)=>s(this,void 0,void 0,(function*(){try{const o=new URL(t.body.url);o.pathname="/sdapi/v1/sd-vae";const n=yield fetch(o,{method:"GET",headers:{Authorization:d(t.body.auth)}});if(!n.ok)throw new Error("SD WebUI returned an error.");const r=yield n.json();return e.send(r)}catch(t){return console.log(t),e.sendStatus(500)}})))),t.post("/loras",e,((t,e)=>s(this,void 0,void 0,(function*(){try{const o=new URL(t.body.url);o.pathname="/sdapi/v1/loras";const n=yield fetch(o,{method:"GET",headers:{Authorization:d(t.body.auth)}});if(!n.ok)throw new Error("SD WebUI returned an error.");const r=yield n.json();return e.send(r)}catch(t){return console.log(t),e.sendStatus(500)}})))),t.post("/controlnet/model_list",e,((t,e)=>s(this,void 0,void 0,(function*(){try{const o=new URL(t.body.url);o.pathname="/controlnet/model_list";const n=yield fetch(o,{method:"GET",headers:{Authorization:d(t.body.auth)}});if(!n.ok)throw new Error("SD WebUI returned an error.");const r=yield n.json();return e.send(r)}catch(t){return console.log(t),e.sendStatus(500)}})))),t.post("/controlnet/modules_list",e,((t,e)=>s(this,void 0,void 0,(function*(){try{const o=new URL(t.body.url);o.pathname="/controlnet/module_list";const n=yield fetch(o,{method:"GET",headers:{Authorization:d(t.body.auth)}});if(!n.ok)throw new Error("SD WebUI returned an error.");const r=yield n.json();return e.send(r)}catch(t){return console.log(t),e.sendStatus(500)}})))),t.post("/controlnet/types",e,((t,e)=>s(this,void 0,void 0,(function*(){try{const o=new URL(t.body.url);o.pathname="/controlnet/control_types";const n=yield fetch(o,{method:"GET",headers:{Authorization:d(t.body.auth)}});if(!n.ok)throw new Error("SD WebUI returned an error.");const r=yield n.json();return e.send(r)}catch(t){return console.log(t),e.sendStatus(500)}})))),console.log(u,"Plugin loaded!")}))}function a(){return s(this,void 0,void 0,(function*(){console.log(u,"Plugin exited")}))}e.info={id:"stwebui",name:"Server Plugin for Silly Tavern Alternative SD Plugin",description:"Allows additional SD Forge/A1111 API endpoints to be used"};const l={init:c,exit:a,info:e.info};e.default=l},268:t=>{t.exports=require("body-parser")}},e={},o=function o(n){var r=e[n];if(void 0!==r)return r.exports;var i=e[n]={exports:{}};return t[n].call(i.exports,i,i.exports,o),i.exports}(156);module.exports=o})();